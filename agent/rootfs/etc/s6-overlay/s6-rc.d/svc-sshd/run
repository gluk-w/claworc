#!/command/with-contenv bash

# Generate host keys if missing
ssh-keygen -A

# Create privilege-separation directory
mkdir -p /run/sshd

# Ensure /root/.ssh directory exists with correct permissions
mkdir -p /root/.ssh
chmod 700 /root/.ssh

echo "Starting sshd in foreground..."
# Redirect stderr to log file for SSH-based log streaming.
# The -e flag sends sshd debug info to stderr.
exec /usr/sbin/sshd -D -e >> /var/log/claworc/sshd.log 2>&1
